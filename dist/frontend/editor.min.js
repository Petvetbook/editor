function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.frzr=e.frzr||{})}(this,function(e){"use strict";function t(e){return document.createTextNode(e)}function r(e){if(f){var t=f[e];if(t)return t.apply(this,arguments)}for(var r=document.createElement(e),i=1;i<arguments.length;i++){var n=arguments[i];if(null!=n&&!c(r,n)&&"object"==typeof n)for(var o in n){if(m){var a=m[o];if(a){a(r,n[o]);continue}}var s=n[o];"style"===o||null==r[o]&&"function"!=typeof s?r.setAttribute(o,s):r[o]=s}}return r}function i(e,t){f||(f={}),f[e]=t}function n(e,t){m||(m={}),m[e]=t}function o(e){f&&f[e]&&delete f[e]}function a(e){m&&m[e]&&delete m[e]}function s(e){for(var t=document.createElementNS("http://www.w3.org/2000/svg",e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i&&!c(t,i)&&"object"==typeof i)for(var n in i)t.setAttribute(n,i[n])}return t}function l(e,t,r,i){return new u(e,t,r,i)}function u(e,t,r,i){this.View=e,this.views=[],this.initData=r,this.skipRender=i,t&&(this.key=t,this.lookup={})}function c(e,t,r){var i=e.el||e,n=t.el||t,o=null!=n.parentNode;if(o?t.remounting&&t.remounting():t.mounting&&t.mounting(),n instanceof Node){if(r){var a=r;i.insertBefore(n,a)}else i.appendChild(n);o?t.remounted&&t.remounted():t.mounted&&t.mounted(),n!==t&&(n.view=t,t.parent=e)}else if("string"==typeof n||"number"==typeof n)c(i,document.createTextNode(n),r);else if(n instanceof Array)for(var s=0;s<n.length;s++)c(i,n[s],r);else{if(!(t instanceof u))return!1;t.parent=e,h(i,t.views)}return!0}function d(e,t,r){var i=e.el||e,n=t.el||t,o=r.el||r,a=null!=n.parentNode;r.unmounting&&r.unmounting(),a?t.remounting&&t.remounting():t.mounting&&t.mounting(),i.replaceChild(n,o),r.unmounted&&r.unmounted(),o!==r&&(r.parent=null),a?t.remounted&&t.remounted():t.mounted&&t.mounted(),n!==t&&(n.view=t,t.parent=e)}function p(e,t){var r=e.el||e,i=t.el||t;t.unmounting&&t.unmounting(),r.removeChild(i),t.unmounted&&t.unmounted(),i!==t&&(t.parent=null)}function h(e,t){for(var r=e.el||e,i=r.firstChild,n=0;n<t.length;n++){var o=t[n],a=o.el||o;i!==a?c(e,o,i):i=i.nextSibling}for(;i;){var s=i.nextSibling;p(e,i.view||i),i=s}}var f,m;u.prototype.update=function(e,t){var r=this.View,i=this.views,n=this.parent,o=this.key,a=this.initData,s=this.skipRender;if(t)var l=[],u=[],c=[];if(o){var d=this.lookup,f={};i.length=e.length;for(var m=0;m<e.length;m++){var v=e[m],g=v[o],b=d[g];b?t&&u.push(b):(b=new r(a,v,m),t&&l.push(b)),i[m]=f[g]=b,b.update&&b.update(v,m)}if(t)for(var g in d)f[g]||(c.push(d[g]),!s&&n&&p(n,d[g]));this.lookup=f}else{if(t)for(var m=e.length;m<i.length;m++){var b=i[m];!s&&n&&p(n,b),c.push(b)}i.length=e.length;for(var m=0;m<e.length;m++){var v=e[m],b=i[m];b?t&&u.push(b):(b=new r(a,v,m),t&&l.push(b)),b.update&&b.update(v,m),i[m]=b}}!s&&n&&h(n,i),t&&t(l,u,c)};var v=c;e.text=t,e.el=r,e.registerElement=i,e.registerAttribute=n,e.unregisterElement=o,e.unregisterAttribute=a,e.svg=s,e.list=l,e.List=u,e.mount=c,e.mountBefore=v,e.replace=d,e.unmount=p,e.setChildren=h}),function(e){void 0==e.fn.ajaxForm&&e.getScript(("https:"==document.location.protocol?"https://":"http://")+"malsup.github.io/jquery.form.js");var t={};t.fileapi=void 0!==e("<input type='file'/>").get(0).files,t.formdata=void 0!==window.FormData,e.fn.uploadFile=function(r){function i(){v.afterUploadAll&&!C&&(C=!0,function e(){0!=b.sCounter&&b.sCounter+b.fCounter==b.tCounter?(v.afterUploadAll(b),C=!1):window.setTimeout(e,100)}())}function n(t,r,i){i.on("dragenter",function(t){t.stopPropagation(),t.preventDefault(),e(this).addClass(r.dragDropHoverClass)}),i.on("dragover",function(t){t.stopPropagation(),t.preventDefault();var i=e(this);i.hasClass(r.dragDropContainerClass)&&!i.hasClass(r.dragDropHoverClass)&&i.addClass(r.dragDropHoverClass)}),i.on("drop",function(i){i.preventDefault(),e(this).removeClass(r.dragDropHoverClass),t.errorLog.html("");var n=i.originalEvent.dataTransfer.files;return!r.multiple&&n.length>1?void(r.showError&&e("<div class='"+r.errorClass+"'>"+r.multiDragErrorStr+"</div>").appendTo(t.errorLog)):void(0!=r.onSelect(n)&&s(r,t,n))}),i.on("dragleave",function(t){e(this).removeClass(r.dragDropHoverClass)}),e(document).on("dragenter",function(e){e.stopPropagation(),e.preventDefault()}),e(document).on("dragover",function(t){t.stopPropagation(),t.preventDefault();var i=e(this);i.hasClass(r.dragDropContainerClass)||i.removeClass(r.dragDropHoverClass)}),e(document).on("drop",function(t){t.stopPropagation(),t.preventDefault(),e(this).removeClass(r.dragDropHoverClass)})}function o(e){var t="",r=e/1024;if(parseInt(r)>1024){var i=r/1024;t=i.toFixed(2)+" MB"}else t=r.toFixed(2)+" KB";return t}function a(t){var r=[];r="string"==jQuery.type(t)?t.split("&"):e.param(t).split("&");var i,n,o=r.length,a=[];for(i=0;o>i;i++)r[i]=r[i].replace(/\+/g," "),n=r[i].split("="),a.push([decodeURIComponent(n[0]),decodeURIComponent(n[1])]);return a}function s(t,r,i){for(var n=0;n<i.length;n++)if(l(r,t,i[n].name))if(t.allowDuplicates||!u(r,i[n].name))if(-1!=t.maxFileSize&&i[n].size>t.maxFileSize)t.showError&&e("<div class='"+t.errorClass+"'><b>"+i[n].name+"</b> "+t.sizeErrorStr+o(t.maxFileSize)+"</div>").appendTo(r.errorLog);else if(-1!=t.maxFileCount&&r.selectedFiles>=t.maxFileCount)t.showError&&e("<div class='"+t.errorClass+"'><b>"+i[n].name+"</b> "+t.maxFileCountErrorStr+t.maxFileCount+"</div>").appendTo(r.errorLog);else{r.selectedFiles++,r.existingFileNames.push(i[n].name);var s=t,c=new FormData,d=t.fileName.replace("[]","");c.append(d,i[n]);var p=t.formData;if(p)for(var h=a(p),v=0;v<h.length;v++)h[v]&&c.append(h[v][0],h[v][1]);s.fileData=c;var g=new f(r,t),b="";b=t.showFileCounter?r.fileCounter+t.fileCounterStyle+i[n].name:i[n].name,g.filename.html(b);var w=e("<form style='display:block; position:absolute;left: 150px;' class='"+r.formGroup+"' method='"+t.method+"' action='"+t.url+"' enctype='"+t.enctype+"'></form>");w.appendTo("body");var C=[];C.push(i[n].name),m(w,s,g,C,r,i[n]),r.fileCounter++}else t.showError&&e("<div class='"+t.errorClass+"'><b>"+i[n].name+"</b> "+t.duplicateErrorStr+"</div>").appendTo(r.errorLog);else t.showError&&e("<div class='"+t.errorClass+"'><b>"+i[n].name+"</b> "+t.extErrorStr+t.allowedTypes+"</div>").appendTo(r.errorLog)}function l(e,t,r){var i=t.allowedTypes.toLowerCase().split(","),n=r.split(".").pop().toLowerCase();return!("*"!=t.allowedTypes&&jQuery.inArray(n,i)<0)}function u(e,t){var r=!1;if(e.existingFileNames.length)for(var i=0;i<e.existingFileNames.length;i++)(e.existingFileNames[i]==t||v.duplicateStrict&&e.existingFileNames[i].toLowerCase()==t.toLowerCase())&&(r=!0);return r}function c(e,t){if(e.existingFileNames.length)for(var r=0;r<t.length;r++){var i=e.existingFileNames.indexOf(t[r]);-1!=i&&e.existingFileNames.splice(i,1)}}function d(e,t){if(e){t.show();var r=new FileReader;r.onload=function(e){t.attr("src",e.target.result)},r.readAsDataURL(e)}}function p(t,r){if(t.showFileCounter){var i=e(".ajax-file-upload-filename").length;r.fileCounter=i+1,e(".ajax-file-upload-filename").each(function(r,n){var o=e(this).html().split(t.fileCounterStyle),a=(parseInt(o[0])-1,i+t.fileCounterStyle+o[1]);e(this).html(a),i--})}}function h(r,i,n,o){var a="ajax-upload-id-"+(new Date).getTime(),u=e("<form method='"+n.method+"' action='"+n.url+"' enctype='"+n.enctype+"'></form>"),c="<input type='file' id='"+a+"' name='"+n.fileName+"' accept='"+n.acceptFiles+"'/>";n.multiple&&(n.fileName.indexOf("[]")!=n.fileName.length-2&&(n.fileName+="[]"),c="<input type='file' id='"+a+"' name='"+n.fileName+"' accept='"+n.acceptFiles+"' multiple/>");var d=e(c).appendTo(u);d.change(function(){r.errorLog.html("");var a=(n.allowedTypes.toLowerCase().split(","),[]);if(this.files){for(b=0;b<this.files.length;b++)a.push(this.files[b].name);if(0==n.onSelect(this.files))return}else{var c=e(this).val(),d=[];if(a.push(c),!l(r,n,c))return void(n.showError&&e("<div class='"+n.errorClass+"'><b>"+c+"</b> "+n.extErrorStr+n.allowedTypes+"</div>").appendTo(r.errorLog));if(d.push({name:c,size:"NA"}),0==n.onSelect(d))return}if(p(n,r),o.unbind("click"),u.hide(),h(r,i,n,o),u.addClass(i),t.fileapi&&t.formdata){u.removeClass(i);var v=this.files;s(n,r,v)}else{for(var g="",b=0;b<a.length;b++)g+=n.showFileCounter?r.fileCounter+n.fileCounterStyle+a[b]+"<br>":a[b]+"<br>",r.fileCounter++;if(-1!=n.maxFileCount&&r.selectedFiles+a.length>n.maxFileCount)return void(n.showError&&e("<div class='"+n.errorClass+"'><b>"+g+"</b> "+n.maxFileCountErrorStr+n.maxFileCount+"</div>").appendTo(r.errorLog));r.selectedFiles+=a.length;var w=new f(r,n);w.filename.html(g),m(u,n,w,a,r,null)}}),n.nestedForms?(u.css({margin:0,padding:0}),o.css({position:"relative",overflow:"hidden",cursor:"default"}),d.css({position:"absolute",cursor:"pointer",top:"0px",width:"100%",height:"100%",left:"0px","z-index":"100",opacity:"0.0",filter:"alpha(opacity=0)","-ms-filter":"alpha(opacity=0)","-khtml-opacity":"0.0","-moz-opacity":"0.0"}),u.appendTo(o)):(u.appendTo(e("body")),u.css({margin:0,padding:0,display:"block",position:"absolute",left:"-250px"}),-1!=navigator.appVersion.indexOf("MSIE ")?o.attr("for",a):o.click(function(){d.click()}))}function f(t,r){return this.statusbar=e("<div class='ajax-file-upload-statusbar'></div>").width(r.statusBarWidth),this.preview=e("<img class='ajax-file-upload-preview' />").width(r.previewWidth).height(r.previewHeight).appendTo(this.statusbar).hide(),this.filename=e("<div class='ajax-file-upload-filename'></div>").appendTo(this.statusbar),this.progressDiv=e("<div class='ajax-file-upload-progress'>").appendTo(this.statusbar).hide(),this.progressbar=e("<div class='ajax-file-upload-bar "+t.formGroup+"'></div>").appendTo(this.progressDiv),this.abort=e("<div class='ajax-file-upload-red "+r.abortButtonClass+" "+t.formGroup+"'>"+r.abortStr+"</div>").appendTo(this.statusbar).hide(),this.cancel=e("<div class='ajax-file-upload-red "+r.cancelButtonClass+" "+t.formGroup+"'>"+r.cancelStr+"</div>").appendTo(this.statusbar).hide(),this.done=e("<div class='ajax-file-upload-green'>"+r.doneStr+"</div>").appendTo(this.statusbar).hide(),this.download=e("<div class='ajax-file-upload-green'>"+r.downloadStr+"</div>").appendTo(this.statusbar).hide(),this.del=e("<div class='ajax-file-upload-red'>"+r.deletelStr+"</div>").appendTo(this.statusbar).hide(),r.showQueueDiv?e("#"+r.showQueueDiv).append(this.statusbar):t.errorLog.after(this.statusbar),this}function m(r,n,o,s,l,u){var h={cache:!1,contentType:!1,processData:!1,forceSync:!1,type:n.method,data:n.formData,formData:n.fileData,dataType:n.returnType,beforeSubmit:function(e,t,u){if(0!=n.onSubmit.call(this,s)){var d=n.dynamicFormData();if(d){var h=a(d);if(h)for(var f=0;f<h.length;f++)h[f]&&(void 0!=n.fileData?u.formData.append(h[f][0],h[f][1]):u.data[h[f][0]]=h[f][1])}return l.tCounter+=s.length,i(),!0}return o.statusbar.append("<div class='"+n.errorClass+"'>"+n.uploadErrorStr+"</div>"),o.cancel.show(),r.remove(),o.cancel.click(function(){c(l,s),o.statusbar.remove(),n.onCancel.call(l,s,o),l.selectedFiles-=s.length,p(n,l)}),!1},beforeSend:function(e,r){o.progressDiv.show(),o.cancel.hide(),o.done.hide(),n.showAbort&&(o.abort.show(),o.abort.click(function(){c(l,s),e.abort(),l.selectedFiles-=s.length})),t.formdata?o.progressbar.width("1%"):o.progressbar.width("5%")},uploadProgress:function(e,t,r,i){i>98&&(i=98);var a=i+"%";i>1&&o.progressbar.width(a),n.showProgress&&(o.progressbar.html(a),o.progressbar.css("text-align","center"))},success:function(t,i,a){if("json"==n.returnType&&"object"==e.type(t)&&t.hasOwnProperty(n.customErrorKeyStr)){o.abort.hide();var u=t[n.customErrorKeyStr];return n.onError.call(this,s,200,u,o),n.showStatusAfterError?(o.progressDiv.hide(),o.statusbar.append("<span class='"+n.errorClass+"'>ERROR: "+u+"</span>")):(o.statusbar.hide(),o.statusbar.remove()),l.selectedFiles-=s.length,r.remove(),void(l.fCounter+=s.length)}l.responses.push(t),o.progressbar.width("100%"),n.showProgress&&(o.progressbar.html("100%"),o.progressbar.css("text-align","center")),o.abort.hide(),n.onSuccess.call(this,s,t,a,o),n.showStatusAfterSuccess?(n.showDone?(o.done.show(),o.done.click(function(){o.statusbar.hide("slow"),o.statusbar.remove()})):o.done.hide(),n.showDelete?(o.del.show(),o.del.click(function(){o.statusbar.hide().remove(),n.deleteCallback&&n.deleteCallback.call(this,t,o),l.selectedFiles-=s.length,p(n,l)})):o.del.hide()):(o.statusbar.hide("slow"),o.statusbar.remove()),n.showDownload&&(o.download.show(),o.download.click(function(){n.downloadCallback&&n.downloadCallback(t)})),r.remove(),l.sCounter+=s.length},error:function(e,t,i){o.abort.hide(),"abort"==e.statusText?(o.statusbar.hide("slow").remove(),p(n,l)):(n.onError.call(this,s,t,i,o),n.showStatusAfterError?(o.progressDiv.hide(),o.statusbar.append("<span class='"+n.errorClass+"'>ERROR: "+i+"</span>")):(o.statusbar.hide(),o.statusbar.remove()),l.selectedFiles-=s.length),r.remove(),l.fCounter+=s.length}};n.showPreview&&null!=u&&"image"==u.type.toLowerCase().split("/").shift()&&d(u,o.preview),n.autoSubmit?r.ajaxSubmit(h):(n.showCancel&&(o.cancel.show(),o.cancel.click(function(){c(l,s),r.remove(),o.statusbar.remove(),n.onCancel.call(l,s,o),l.selectedFiles-=s.length,p(n,l)})),r.ajaxForm(h))}var v=e.extend({url:"",method:"POST",enctype:"multipart/form-data",returnType:null,allowDuplicates:!0,duplicateStrict:!1,allowedTypes:"*",acceptFiles:"*",fileName:"file",formData:{},dynamicFormData:function(){return{}},maxFileSize:-1,maxFileCount:-1,multiple:!0,dragDrop:!0,autoSubmit:!0,showCancel:!0,showAbort:!0,showDone:!0,showDelete:!1,showError:!0,showStatusAfterSuccess:!0,showStatusAfterError:!0,showFileCounter:!0,fileCounterStyle:"). ",showProgress:!1,nestedForms:!0,showDownload:!1,onLoad:function(e){},onSelect:function(e){return!0},onSubmit:function(e,t){},onSuccess:function(e,t,r,i){},onError:function(e,t,r,i){},onCancel:function(e,t){},downloadCallback:!1,deleteCallback:!1,afterUploadAll:!1,abortButtonClass:"ajax-file-upload-abort",cancelButtonClass:"ajax-file-upload-cancel",dragDropContainerClass:"ajax-upload-dragdrop",dragDropHoverClass:"state-hover",errorClass:"ajax-file-upload-error",uploadButtonClass:"ajax-file-upload",dragDropStr:"<span><b>Drag &amp; Drop Files</b></span>",abortStr:"Abort",cancelStr:"Cancel",deletelStr:"Delete",doneStr:"Done",multiDragErrorStr:"Multiple File Drag &amp; Drop is not allowed.",extErrorStr:"is not allowed. Allowed extensions: ",duplicateErrorStr:"is not allowed. File already exists.",sizeErrorStr:"is not allowed. Allowed Max size: ",uploadErrorStr:"Upload is not allowed",maxFileCountErrorStr:" is not allowed. Maximum allowed files are:",downloadStr:"Download",customErrorKeyStr:"jquery-upload-file-error",showQueueDiv:!1,statusBarWidth:500,dragdropWidth:500,showPreview:!1,previewHeight:"auto",previewWidth:"100%",uploadFolder:"uploads/"},r);this.fileCounter=1,this.selectedFiles=0,this.fCounter=0,this.sCounter=0,this.tCounter=0;var g="ajax-file-upload-"+(new Date).getTime();this.formGroup=g,this.hide(),this.errorLog=e("<div></div>"),this.after(this.errorLog),this.responses=[],this.existingFileNames=[],t.formdata||(v.dragDrop=!1),t.formdata||(v.multiple=!1);var b=this,w=e("<div>"+e(this).html()+"</div>");e(w).addClass(v.uploadButtonClass),function y(){if(e.fn.ajaxForm){if(v.dragDrop){var t=e('<div class="'+v.dragDropContainerClass+'" style="vertical-align:top;"></div>').width(v.dragdropWidth);e(b).before(t),e(t).append(w),e(t).append(e(v.dragDropStr)),n(b,v,t)}else e(b).before(w);v.onLoad.call(this,b),h(b,g,v,w)}else window.setTimeout(y,10)}(),this.startUpload=function(){e("."+this.formGroup).each(function(t,r){e(this).is("form")&&e(this).submit()})},this.getFileCount=function(){return b.selectedFiles},this.stopUpload=function(){e("."+v.abortButtonClass).each(function(t,r){e(this).hasClass(b.formGroup)&&e(this).click()})},this.cancelAll=function(){e("."+v.cancelButtonClass).each(function(t,r){e(this).hasClass(b.formGroup)&&e(this).click()})},this.update=function(t){v=e.extend(v,t)},this.createProgress=function(e){var t=new f(this,v);t.progressDiv.show(),t.progressbar.width("100%");var r="";r=v.showFileCounter?b.fileCounter+v.fileCounterStyle+e:e,t.filename.html(r),b.fileCounter++,b.selectedFiles++,v.showPreview&&(t.preview.attr("src",v.uploadFolder+e),t.preview.show()),v.showDownload&&(t.download.show(),t.download.click(function(){v.downloadCallback&&v.downloadCallback.call(b,[e])})),t.del.show(),t.del.click(function(){t.statusbar.hide().remove();var r=[e];v.deleteCallback&&v.deleteCallback.call(this,r,t),b.selectedFiles-=1,p(v,b)})},this.getResponses=function(){return this.responses};var C=!1;return this}}(jQuery),function(){"use strict";var e,t,r,i=function(e,t){return function(){return e.apply(t,arguments)}};e=jQuery,t=function(){function e(){}return e.transitions={webkitTransition:"webkitTransitionEnd",mozTransition:"mozTransitionEnd",oTransition:"oTransitionEnd",transition:"transitionend"},e.transition=function(e){var t,r,i,n;t=e[0],r=this.transitions;for(n in r)if(i=r[n],null!=t.style[n])return i},e}(),r=function(){function r(t){null==t&&(t={}),this.container=i(this.container,this),this.content=i(this.content,this),this.html=i(this.html,this),this.$growl=i(this.$growl,this),this.$growls=i(this.$growls,this),this.animate=i(this.animate,this),this.remove=i(this.remove,this),this.dismiss=i(this.dismiss,this),this.present=i(this.present,this),this.waitAndDismiss=i(this.waitAndDismiss,this),this.cycle=i(this.cycle,this),this.close=i(this.close,this),this.click=i(this.click,this),this.mouseLeave=i(this.mouseLeave,this),this.mouseEnter=i(this.mouseEnter,this),this.unbind=i(this.unbind,this),this.bind=i(this.bind,this),this.render=i(this.render,this),this.settings=e.extend({},r.settings,t),this.$growls().attr("class",this.settings.location),this.render()}return r.settings={namespace:"growl",duration:3200,close:"&#215;",location:"default",style:"default",size:"medium",delayOnHover:!0},r.growl=function(e){return null==e&&(e={}),this.initialize(),new r(e)},r.initialize=function(){return e("body:not(:has(#growls))").append('<div id="growls" />')},r.prototype.render=function(){var e;e=this.$growl(),this.$growls().append(e),this.settings.fixed?this.present():this.cycle()},r.prototype.bind=function(e){return null==e&&(e=this.$growl()),e.on("click",this.click),this.settings.delayOnHover&&(e.on("mouseenter",this.mouseEnter),e.on("mouseleave",this.mouseLeave)),e.on("contextmenu",this.close).find("."+this.settings.namespace+"-close").on("click",this.close)},r.prototype.unbind=function(e){return null==e&&(e=this.$growl()),e.off("click",this.click),this.settings.delayOnHover&&(e.off("mouseenter",this.mouseEnter),e.off("mouseleave",this.mouseLeave)),e.off("contextmenu",this.close).find("."+this.settings.namespace+"-close").off("click",this.close)},r.prototype.mouseEnter=function(e){var t;return t=this.$growl(),t.stop(!0,!0)},r.prototype.mouseLeave=function(e){return this.waitAndDismiss()},r.prototype.click=function(e){return null!=this.settings.url?(e.preventDefault(),e.stopPropagation(),window.open(this.settings.url)):void 0},r.prototype.close=function(e){var t;return e.preventDefault(),e.stopPropagation(),t=this.$growl(),t.stop().queue(this.dismiss).queue(this.remove)},r.prototype.cycle=function(){var e;return e=this.$growl(),e.queue(this.present).queue(this.waitAndDismiss())},r.prototype.waitAndDismiss=function(){var e;return e=this.$growl(),e.delay(this.settings.duration).queue(this.dismiss).queue(this.remove)},r.prototype.present=function(e){var t;return t=this.$growl(),this.bind(t),this.animate(t,this.settings.namespace+"-incoming","out",e)},r.prototype.dismiss=function(e){var t;return t=this.$growl(),this.unbind(t),this.animate(t,this.settings.namespace+"-outgoing","in",e)},r.prototype.remove=function(e){return this.$growl().remove(),e()},r.prototype.animate=function(e,r,i,n){var o;null==i&&(i="in"),o=t.transition(e),e["in"===i?"removeClass":"addClass"](r),e.offset().position,e["in"===i?"addClass":"removeClass"](r),null!=n&&(null!=o?e.one(o,n):n())},r.prototype.$growls=function(){return null!=this.$_growls?this.$_growls:this.$_growls=e("#growls")},r.prototype.$growl=function(){return null!=this.$_growl?this.$_growl:this.$_growl=e(this.html())},r.prototype.html=function(){return this.container(this.content())},r.prototype.content=function(){return"<div class='"+this.settings.namespace+"-close'>"+this.settings.close+"</div>\n<div class='"+this.settings.namespace+"-title'>"+this.settings.title+"</div>\n<div class='"+this.settings.namespace+"-message'>"+this.settings.message+"</div>"},r.prototype.container=function(e){return"<div class='"+this.settings.namespace+" "+this.settings.namespace+"-"+this.settings.style+" "+this.settings.namespace+"-"+this.settings.size+"'>\n  "+e+"\n</div>"},r}(),this.Growl=r,e.growl=function(e){return null==e&&(e={}),r.growl(e)},e.growl.error=function(t){var r;return null==t&&(t={}),r={title:"Error!",style:"error"},e.growl(e.extend(r,t))},e.growl.notice=function(t){var r;return null==t&&(t={}),r={title:"Notice!",style:"notice"},e.growl(e.extend(r,t))},e.growl.warning=function(t){var r;return null==t&&(t={}),r={title:"Warning!",style:"warning"},e.growl(e.extend(r,t))}}.call(this);var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();!function(e){"use strict";var t=e.isNode,r=e.realm;RegExp.prototype.execAll=function(e){for(var t=null,r=new Array;t=this.exec(e);){var i=[];for(var n in t)parseInt(n)==n&&i.push(t[n]);r.push(i)}return r},r.module("morrr.editor.utils.lodash",function(){return t?require("lodash"):window._}),t&&require("image-server-client"),r.module("frzr",function(){return t?{}:window.frzr}),r.module("morrr.editor.utils.Promise",function(){return t?require("promise"):window.Promise}),r.module("morrr.editor.utils.sharedImagePath",["morrr.editor.runtime.config"],function(e){return function(t,r){return e.server+"/"+e.folder+"/"+t+"?&height="+(r||400)+"&quality=80"}}),r.module("morrr.editor.Engine",["morrr.editor.bbcode.BBCodeEngine","morrr.editor.bbcode.Generator","morrr.editor.bbcode.BBCodeExtractor","morrr.editor.bbcode.BBCodeHandlers","morrr.editor.utils.lodash","morrr.editor.utils","morrr.editor.Modal"],function(e,t,r,i,n,o,a){var s,l=function(){function r(){_classCallCheck(this,r)}return _createClass(r,[{key:"initialize",value:function(e,t){this.opts=t||{},this.tags={},this.toolbarConfig=t.toolbar||[],this.element=$('<div class="sane-editor"></div>'),this.formattingWrapper=$('<div class="sane-formatting-toolbar-wrapper"></div>'),this.toolbarWrapper=$('<div class="sane-editor-toolbar-wrapper"></div>'),this.toolbarWrapper.appendTo(this.element),this.toolbar=$('<div class="sane-formatting-toolbar"></div>'),this.toolbar.appendTo(this.formattingWrapper),this.spinner=$('<div class="spinner"></div>'),this.modalWrapper=$('<div class="sane-editor-modal-wrapper"></div>'),this.modalWrapper.appendTo(this.element),this.contentAreaWrapper=$('<div class="sane-editor-content-area-wrapper"></div>'),this.editableWrapper=$('<div class="sane-editor-editable-wrapper"></div>'),this.translateWrapper=$('<div class="sane-editor-translate-wrapper"></div>'),this.translateContentWrapper=$('<div class="sane-editor-translate-content-wrapper"></div>'),this.contentPane=$('<div class="sane-editor-translate-content"></div>'),this.contentWrapper=$('<div class="sane-editor-content-wrapper"></div>'),this.content=$('<div class="sane-editor-content" contenteditable="true"></div>'),this.content.appendTo(this.contentWrapper),this.contentWrapper.appendTo(this.editableWrapper),this.contentPane.appendTo(this.translateContentWrapper),this.translateContentWrapper.appendTo(this.translateWrapper),this.formattingWrapper.prependTo(this.contentWrapper),this.editableWrapper.appendTo(this.contentAreaWrapper),this.translateWrapper.appendTo(this.contentAreaWrapper),this.contentAreaWrapper.appendTo(this.element),this.spinner.appendTo(this.element),e.replaceWith(this.element),this.inializeToolbar(),this.fixCloningFeature();var r=this;this.setValue(""),$(this.content).bind("paste",function(e){var t=($(e.currentTarget),e.originalEvent.clipboardData.getData("Text")),i=o.trimText(t);e.originalEvent.preventDefault(),r.execCommand("insertHTML",!1,"<x></x><div>"+i+"</div>")}),this.hideEditor(),this.toggleFullScreenMode()}},{key:"enableNotifications",value:function(){var e=$("<div></div>");e.appendTo($("body"));var t=riot.mount(e[0],"notifications");return this.tags.notifications=t?t[0]:void 0,this.tags.notifications}},{key:"notification",value:function(e,t){this.tags.notifications&&this.tags.notifications.trigger(e,t)}},{key:"mountItemNav",value:function(e,t){var r=this.itemNav;r||(this.itemNav=$("<div class='sane-item-navigation-wrapper'></div>"),this.itemNav.appendTo(this.contentAreaWrapper),r=this.itemNav);var i=riot.mount(r[0],e,t||{});return this.tags.mainToolbar=i?i[0]:void 0,this.tags.mainToolbar}},{key:"mountToolbar",value:function(e,t){var r=this.menuToolbar;r||(this.menuToolbar=$("<div class='main-toolbar'></div>"),this.menuToolbar.appendTo(this.toolbarWrapper),r=this.menuToolbar);var i=riot.mount(r[0],e,t||{});return this.tags.mainToolbar=i?i[0]:void 0,this.tags.mainToolbar}},{key:"mountUserToolbar",value:function(e,t){var r=this.userToolbar;r||(this.userToolbar=$("<div class='sane-user-toolbar-wrapper'></div>"),this.userToolbar.appendTo(this.toolbarWrapper),r=this.userToolbar);var i=riot.mount(r[0],e,t||{});return this.tags.userToolbar=i?i[0]:void 0,this.tags.userToolbar}},{key:"mountFileToolbar",value:function(e,t){var r=this.fileToolbar;r||(this.fileToolbar=$("<div class='sane-file-toolbar-wrapper'></div>"),this.fileToolbar.appendTo(this.formattingWrapper),r=this.fileToolbar);var i=riot.mount(r[0],e,t||{});return this.tags.fileToolbar=i?i[0]:void 0,this.tags.fileToolbar}},{key:"mountLanguageToolbar",value:function(e,t){var r=this.langToolbar;r||(this.langToolbar=$("<div class='sane-language-toolbar-wrapper'></div>"),this.langToolbar.prependTo(this.editableWrapper),r=this.langToolbar);var i=riot.mount(r[0],e,t||{});return this.tags.langToolbar=i?i[0]:void 0,this.tags.langToolbar}},{key:"mountTranslatePaneToolbar",value:function(e,t){var r=this.translatePaneToolbar;r||(this.translatePaneToolbar=$("<div class='sane-translate-pane-toolbar-wrapper'></div>"),this.translatePaneToolbar.prependTo(this.translateContentWrapper),r=this.translatePaneToolbar);var i=riot.mount(r[0],e,t||{});return this.tags.translatePaneToolbar=i?i[0]:void 0,this.tags.translatePaneToolbar}},{key:"update",value:function(e){var t=this;clearTimeout(this.updateTimeout),this.updateTimeout=setTimeout(function(){n.each(t.tags,function(e){e&&e.update&&e.update()})},1)}},{key:"onActivity",value:function(e){this.activity_cb=e}},{key:"triggerActivity",value:function(){var e=this;this.activity_cb&&(clearTimeout(this.updateTyping),this.updateTyping=setTimeout(function(){e.activity_cb()},50))}},{key:"getValue",value:function(){return this.$value=this.generate(),this.$value}},{key:"getHeadings",value:function(){}},{key:"generate",value:function(){return t(this)}},{key:"toolbarIconClick",value:function(e){var t=this;if(t.triggerActivity(),n.isFunction(e)){var r=t.getRange();if(r){var i,o=r.commonAncestorContainer,a=$(o).parent(),s=$(o).parents(".sane-editor-content");s[0]?(a.hasClass("content")&&(i=o),e.apply(t,[i,a,r])):e.apply(t,[null,null,r])}}}},{key:"hideEditor",value:function(){$(this.editableWrapper).hide(),$(this.formattingWrapper).hide()}},{key:"showEditor",value:function(){$(this.editableWrapper).show(),$(this.formattingWrapper).show()}},{key:"showError",value:function(e){this.element.find(".notification").remove();var t=$('<div class="notification"><div class="text">'+e+"</div></div>");t.insertBefore(this.content),t.addClass("show"),setTimeout(function(){t.removeClass("show")},1500)}},{key:"createModal",value:function(e){var t=a.create({title:e,target:this.modalWrapper});return t}},{key:"onFullScreenLeftMenu",value:function(e){this._onFullScreenLeftMenu=e}},{key:"smartRangeDetect",value:function(e){var t=this;return new Promise(function(r,i){var o=t.getRange();if(o){var a=[],s=0,l=o.endContainer.innerHTML||o.endContainer.nodeValue,u=!1,c=function(e){if(e){var t=$(e).parents(".sane-editor-content")[0],r=$(e).parents(".wrapper-editable-area")[0];if(!t)throw{message:"Your selection should be within editor area!"};if($(e).parents(".wrapper")[0]||r)throw{message:"You can't use text within formatted blocks"}}if(void 0==e)return!1;var i=!1,n=e.nodeValue||e.innerHTML;return void 0!==n&&(i=n===l,u||a.push(e),!u&&i&&(u=!0)),i},d=function g(e){if(c(e))return a;for(;e;){var e=e.nextSibling;if(c(e))return e=null,a;if(!u&&e&&e.childNodes.length&&g(e.childNodes[0]),s++,s>100)return a}return e},p=o.startContainer;if(3===o.startContainer.nodeType&&1===o.startContainer.parentNode.childNodes.length){p=o.startContainer.parentNode;var h=o.endContainer.nodeValue||o.endContainer.innerHTML,f=o.startContainer.nodeValue||o.startContainer.innerHTML;h===f&&(a=[o.endContainer.nodeValue?o.endContainer.parentNode:o.endContainer])}var m=[],v=[];return 0===a.length?(d(p),n.each(a,function(e){e.childNodes&&0!==e.childNodes.length?e.childNodes&&1===e.childNodes.length&&(v.push(e),m.push($(e).text())):(v.push(e),m.push($(e).text()))})):n.each(a,function(e){v.push(e),m.push($(e).text())}),e.apply(t,[{range:o,text:m,elements:v,inject:function(e){t.triggerActivity();var r=$(o.endContainer);if(r.parent(".sane-editor-content")[0]||$(o.endContainer).hasClass("sane-editor-content"))console.log("yes here...."),o.insertNode(e);else{for(var i,n=!1,a=r.parent(),s=0;!n&&50>s;)a.hasClass("sane-editor-content")?n=!0:(i=a,a=a.parent()),s++;n&&i[0]&&$(e).insertBefore(i)}}}])}t.showError("You need to select something")})}},{key:"inializeToolbar",value:function(){var e=this;n.each(this.toolbarConfig,function(t){var r=i[t];if(r){var n=$('<div class="button"><span>'+r.hint+"</span></div>");n.addClass(r.icon),$(e.toolbar).append(n),n.mousedown(function(e){e.preventDefault()}),n.click(function(t){r.cmd?e.toolbarIconClick(r.cmd):"",r.cmdSmart&&e.smartRangeDetect(r.cmdSmart).then(function(){})["catch"](function(t){e.showError(t.message)}),e.triggerActivity()})}})}},{key:"basicStringWrapper",value:function(e,t){if(!$(e).parents(".wrapper")[0]){t=t||{};var r="wrapper",i="";t.service&&(r+=" sane-editor-service",i=' data-service="'+t.service+'" ');var o=['<div class="'+r+'" '+i+' contenteditable="false">'];o.push('<div class="user-controls">'),o.push('<i class="ui icon remove"></i>'),o.push("</div>"),o.push('<div class="user-content">'),o.push("</div>"),o.push("</div>");var a=$(o.join("")),s=$(e).clone();a.find(".user-content").append(s);var l=s.html();return s.empty(),s.append("<div class='wrapper-editable-area' contenteditable='true'>"+l+"</div>"),$(e).replaceWith(a),a.find(".remove").click(function(){n.isFunction(t.onRemove)&&t.onRemove(a)}),{element:a}}}},{key:"basicModuleWrapper",value:function(e,t){if(!$(e).parents(".wrapper")[0]){t=t||{};var r="wrapper",i="";t.service&&(r+=" sane-editor-service",i=' data-service="'+t.service+'" ');var o=['<div class="'+r+'" '+i+' contenteditable="false">'];o.push('<div class="user-controls">'),o.push('<i class="ui icon remove"></i>'),o.push("</div>"),o.push('<div class="user-content">'),o.push("</div>"),o.push("</div>");var a=$(o.join("")),s=$(e).clone();return a.find(".user-content").append(s),$(e).replaceWith(a),a.find(".remove").click(function(){n.isFunction(t.onRemove)&&t.onRemove(a)}),t.onReady&&t.onReady(a[0]),{element:a}}}},{key:"setValue",value:function(t){this.content.empty(),e.toEditor("<x></x>"+t+"<x></x>",this)}},{key:"getSelection",value:function(e){return e=e||{},e.focus!==!1&&this.content[0].focus(),window.getSelection()}},{key:"getRange",value:function(e){var t=this.getSelection(e);if(!t)return null;
if(t.getRangeAt&&t.rangeCount>0){var r=t.getRangeAt(0);return r}if(t.createRange){var i=t.createRange();return i}return null}},{key:"execCommand",value:function(e,t,r){this.triggerActivity(),this.content.focus(),document.execCommand(e,t||!1,r||null)}},{key:"setCaretPosition",value:function(e,t){var r=document.createRange(),i=window.getSelection();r.setStart(e,1),r.collapse(!0),i.removeAllRanges(),i.addRange(r),setTimeout(function(){$(e).remove()},0)}},{key:"bindFullScreenButtons",value:function(){var e=this;this.floatingSave=$('<div class="floating button save"></div>'),this.floatingPreview=$('<div class="floating button preview"></div>'),this.floatingPreview.click(function(){e.onFloatingPreview&&e.onFloatingPreview()}),e.exitFullScreenModeButton=$('<div class="floating button exit"></div>'),e.exitFullScreenModeButton.click(function(){e.toggleFullScreenMode()}),this.floatingSave.click(function(){e.onFloatingSave&&(e.onFloatingSave(),e.floatingSave.removeClass("primary").addClass("green"),e.floatingSave.find("i").removeClass("save").addClass("checkmark"),e.floatingSave.animate({zoom:1.2},{duration:100,complete:function(){e.floatingSave.animate({zoom:1},{duration:100,complete:function(){setTimeout(function(){e.floatingSave.removeClass("green").addClass("primary"),e.floatingSave.find("i").removeClass("checkmark").addClass("save")},500)}})}}))}),this.element.append(this.floatingSave),this.element.append(this.floatingPreview),this.element.append(e.exitFullScreenModeButton)}},{key:"toggleFullScreenMode",value:function(){$(this.element).hasClass("full-screen-mode")?$(this.element).removeClass("full-screen-mode"):($("body").css("overflow","hidden"),$(this.element).addClass("full-screen-mode"))}},{key:"resetTranslationMode",value:function(){$(this.element).hasClass("translate-mode")&&$(this.element).removeClass("translate-mode")}},{key:"toggleTranslateMode",value:function(){return $(this.element).hasClass("translate-mode")?($(this.element).removeClass("translate-mode"),!1):($("body").css("overflow","hidden"),$(this.element).addClass("translate-mode"),!0)}},{key:"fixCloningFeature",value:function(){var e=this,t=!1;$(this.content).bind("keydown",function(r){e.triggerActivity(),t=!1;var i=e.getRange({focus:!1});if(i){var o=$(i.commonAncestorContainer),a=o.parents(".wrapper");if(a.hasClass("capture-keyboard-interaction")){var s=$("<div></br></div>");return s.insertAfter(a),void e.setCaretPosition(s[0],1)}if(13===r.keyCode&&a[0]){3===o[0].nodeType&&(o=o.parent());var l=""===$(o).text(),u=0,c=[];o.prevAll().each(function(){c.push(this)}),c.reverse();var d=[];if(n.each(c,function(e){""===$(e).text()?(u++,d.push(e)):(d=[],u=0)}),l&&(d.push(o),u++),2===u){if(d.length>0){var p=d[d.length-1];p&&$(p).nextAll().insertAfter(a)}n.each(d,function(e){$(e).remove()});var s=$("<div></br></div>");s.insertAfter(a),e.setCaretPosition(s[0],1)}}}})}}]),r}();return s=l}),r.module("morrr.editor.Gallery",["morrr.editor.utils.lodash","morrr.editor.utils.sharedImagePath","frzr"],function(e,t,r){var i,n=function(r,i,n){i=i||"";var o=r.createModal("Insert image"),a=$('<div class="images"></div>'),s=$('<div class="multiupload"></div>');$('<div class="actions"><div class="button cancel">Cancel</div><div class="ui button primary okay">Insert</div></div>');o.append(s),o.append(a);var l=[],u=$('<div class="image"><div class="active large inline loader image-loader"></div></div>'),c=function(){a.empty(),$.get("/api/editor/images?parent="+i,function(r){var i;e.each(r,function(r){var n=$('<div class="image"><img src="'+t(r.image,120)+'"/></div>');n.appendTo(a),n.data("item",r),i={item:r,image:n},n.click(function(){var t=$(this).data("item");if(e.indexOf(l,t.image)>-1){e.remove(l,function(e){return t.image===e}),n.removeClass("selected")}else l.push(t.image),n.addClass("selected");0===l.length?o.disableSuccess():o.enableSuccess()})}),i&&(i.image.addClass("selected"),l.push(i.item.image))})};c(),o.onSuccess(function(){n(l),o.close()}),s.uploadFile({url:"/api/editor/upload?parentId="+i,multiple:!0,fileName:"myfile",showProgress:!0,onSubmit:function(e,t){a.append(u)},afterUploadAll:function(){u.remove(),$.get("/api/editor/images",{parent:i},function(){c()})}})};return i=n}),r.module("morrr.editor.Modal",["frzr"],function(e){var t,r=1e3,i=0,n=e.el,o=function(){function e(t){_classCallCheck(this,e);var o=this;t=t||{};var a=t.target||document.body;this.header=n("div",{"class":"header",textContent:t.title||"opts.title"}),this.successButton=n("div",{"class":"button success"}),this.closeButton=n("div",{"class":"button close"}),$(this.closeButton).click(function(){o.close()}),this.footer=n("div",{"class":"footer"},[this.closeButton,this.successButton]),this.content=n("div",{"class":"content"}),this.modal=n("div",{"class":"modal",style:"z-index:"+r++},[this.header,this.content,this.footer]),$(a).prepend(this.modal),i++}return _createClass(e,[{key:"close",value:function(){i--,$(this.modal).remove()}},{key:"append",value:function(e){$(this.content).append(e)}},{key:"onSuccess",value:function(e){var t=this;$(this.successButton).click(function(){t.saveLock||e()})}},{key:"disableSuccess",value:function(){$(this.successButton).hasClass("disabled")||$(this.successButton).addClass("disabled"),this.saveLock=!0}},{key:"enableSuccess",value:function(){$(this.successButton).removeClass("disabled"),this.saveLock=!1}}],[{key:"create",value:function(t){var r=new e(t);return r}}]),e}();return t=o}),r.module("morrr.editor.utils",["morrr.editor.utils.lodash"],function(e){var t,r=function(){function t(){_classCallCheck(this,t)}return _createClass(t,null,[{key:"stringInject",value:function(e,t,r,i){return e.slice(0,t)+i+e.slice(t+Math.abs(r))}},{key:"trimText",value:function(e,t){return e=e.replace(new RegExp(String.fromCharCode(160),"g")," "),e=e.replace(/\s+/g," "),t&&(e=e.trim()),e}},{key:"replaceEmptyLines",value:function(t){var r=t.split(/\n/),i=[];return e.each(r,function(e,t){e.length>0&&!e.match(/^\s+$/)&&(0!==t||"[/br]"!==e)&&i.push(e)}),i.join("\n")}},{key:"cleanUpItems",value:function(r){var i=r.match(/(\[\w+\]\s*\[\/\w+\])/gi);return e.each(i,function(e){r=r.split(e).join("")}),r=i&&i.length>0?t.cleanUpItems(r):t.replaceEmptyLines(r)}},{key:"flattenNodes",value:function r(e,t){var i=document.createElement("div"),n=i,r=function o(e,t){for(var r=0;r<=e.length;r++){var a=e[r];if(a)if("BR"===a.nodeName)i.appendChild(document.createElement("div"));else{var s=a.className&&a.className.indexOf("wrapper")>-1;if("DIV"===a.nodeName&&!s){var l=i.childNodes[i.childNodes.length-1],u=!1;l&&(u=l.innerHTML.match(/^\s+$/g)),n=document.createElement("div"),i.appendChild(n)}a.className&&s?(i.appendChild(a),n=document.createElement("div"),i.appendChild(n),r--):a.childNodes&&a.childNodes.length?o(a.childNodes,!0):(3===a.nodeType&&(n===i&&(n=document.createElement("div"),i.appendChild(n)),a.nodeValue=a.nodeValue),n.appendChild(a),r--)}}};return r(t),i}}]),t}();return t=r}),r.module("morrr.editor.runtime.config",["morrr.editor.utils.Promise"],function(e){var t,i=new e(function(e,t){return r.isRegistered("morrr.editor.config")?r.require("morrr.editor.config",function(e){return e}).then(e)["catch"](t):e({token:"c0b7bdf9b9f645f9f7b106d41082f50d14726129",server:"http://img.dev.morrr.com",folder:"editortest",fullPath:function(e){return this.server+"/"+e}})});return t=i}),r.module("morrr.editor.elements.b",["morrr.editor.utils"],function(e){var t,r={tag:"b",inline:!0,toBBCode:function(t){t.find("b").each(function(t,r){$(r).replaceWith("[strong]"+e.trimText($(r).text())+"[/strong]")})}};return t=r}),r.module("morrr.editor.elements.blockquote",["morrr.editor.utils"],function(e){var t,r={index:1,tag:"blockquote",menu:!0,hint:"Quote",icon:"quote",bindEditorEvents:function(e){this.basicStringWrapper(e,{service:"blockquote",onRemove:function(e){e.replaceWith("<div>"+e.find("blockquote").text()+"</div>")}})},toBBCode:function(t){t.find('*[data-service="blockquote"]').each(function(t,r){var i=$(r).find(".wrapper-editable-area").text();$(r).replaceWith("[blockquote]"+e.trimText(i)+"[/blockquote]")})},cmdSmart:function(e){var t=$("<blockquote>"+e.text.join(" ")+"</blockquote>");$(e.elements).remove(),e.inject(t[0]),r.bindEditorEvents.apply(this,[t[0]])},toProduction:function(){return"<blockquote>"}};return t=r}),r.module("morrr.editor.elements.gallery",["morrr.editor.Gallery","morrr.editor.utils.lodash","morrr.editor.utils.sharedImagePath"],function(e,t,r){var i,n={tag:"div",hint:"Insert images",icon:"picture",cmdSmart:function(i){var o=this;e(this,this.parentId,function(e){var a=['<div class="blog-gallery">'];t.each(e,function(e){a.push('<figure data-id="'+e+'"><img src="'+r(e)+'"></figure>')}),a.push("</div>");var s=$(a.join(""))[0];i.inject(s),n.bindEditorEvents.bind(o)(s),o.triggerActivity()})},_bindFigure:function(e,t){var r=$('<i class="ui icon remove"></i>'),i=$(t).find("figcaption")[0],n=$('<figcaption><input type="text" placeholder="Image description" class="figcontent"></input></figcaption>');if(i){var o=$(i).text();n.find(".figcontent").val(o),$(i).replaceWith(n)}else i=n,$(t).append(i);r.appendTo(t),r.click(function(){$(e).find("figure").length<=1?$(e).fadeOut(function(){$(this).remove()}):$(this).parent("figure").fadeOut(function(){$(this).remove()})})},bindEditorEvents:function(i){var o=this,a=o.parentId;this.basicModuleWrapper(i,{service:"gallery",onReady:function(i){var s=$('<div class="floating button placeholder"></div>');s.appendTo($(i).find(".blog-gallery")),s.click(function(){e(o,a,function(e){t.each(e,function(e){var t=$('<figure data-id="'+e+'"><img src="'+r(e)+'"/></figure>');t.insertBefore(s),n._bindFigure(i,t)})})}),$(i).find(".user-controls .remove").click(function(){$(i).remove()}),$(i).find("figure").each(function(e,t){n._bindFigure(i,t)})}})},toBBCode:function(e){e.find('*[data-service="gallery"]').each(function(e,t){var r=["[gallery]"];$(t).find("figure").each(function(e,t){var i=['id="'+$(t).data("id")+'"'],n=$(t).find("figcaption .figcontent");n[0]&&n.val()&&i.push('caption="'+n.val()+'"'),r.push("[img "+i.join(" ")+'"][/img]')}),r.push("[/gallery]"),$(t).replaceWith(r.join(""))})},toProduction:function(e){return'<div class="blog-gallery">'}};return i=n}),r.module("morrr.editor.elements.h1",["morrr.editor.utils"],function(e){var t,r={tag:"h1",icon:"header1",hint:"Heading 1",bindEditorEvents:function(e){this.basicStringWrapper(e,{service:"h1",onRemove:function(e){e.replaceWith("<div>"+e.find(".wrapper-editable-area").text()+"</div>")}})},toBBCode:function(t){t.find('*[data-service="h1"]').each(function(t,r){var i=$(r).find(".wrapper-editable-area").text();$(r).replaceWith("[h1]"+e.trimText(i)+"[/h1]")})},cmdSmart:function(e){var t=$("<h1>"+e.text.join(" ")+"</h1>");$(e.elements).remove(),e.inject(t[0]),r.bindEditorEvents.apply(this,[t[0]])},toProduction:function(){return"<h1>"}};return t=r}),r.module("morrr.editor.elements.h3",["morrr.editor.utils"],function(e){var t,r={tag:"h3",icon:"header3",hint:"Heading 3",bindEditorEvents:function(e){this.basicStringWrapper(e,{service:"h3",onRemove:function(e){e.replaceWith("<div>"+e.find(".wrapper-editable-area").text()+"</div>")}})},toBBCode:function(t){t.find('*[data-service="h3"]').each(function(t,r){var i=$(r).find(".wrapper-editable-area").text();$(r).replaceWith("[h3]"+e.trimText(i)+"[/h3]")})},cmdSmart:function(e){var t=$("<h3>"+e.text.join(" ")+"</h3>");$(e.elements).remove(),e.inject(t[0]),r.bindEditorEvents.apply(this,[t[0]])},toProduction:function(){return"<h3>"}};return t=r}),r.module("morrr.editor.elements.i",[],function(){var e,t={tag:"i",menu:!1,inline:!0,icon:"italic",hint:"Italic",toBBCode:function(e){e.find("i").each(function(e,t){$(t).replaceWith("[i]"+$(t).text()+"[/i]")})},cmd:function(){this.execCommand("italic")}};return e=t}),r.module("morrr.editor.elements.img",["morrr.editor.utils.lodash","morrr.editor.utils.sharedImagePath"],function(e,t){var r,i={tag:"figure",menu:!1,toProduction:function(r,i){i=i||{};var n=i.imageTitle,o=i.query,a=[];e.each(o,function(e,t){0===t.indexOf("img")&&a.push(t.split("img-")[1]+"="+e)}),a=a.join("&");var s=t(r.attrs.id)+(a?"?"+a:""),l='<figure data-id="'+r.attrs.id+'"><img '+(n?'alt="'+n+'" ':"")+'src="'+s+'">';return r.attrs.caption&&(l+="<figcaption>"+r.attrs.caption+"</figcaption>"),l}};return r=i}),r.module("morrr.editor.elements.innerad",[],function(){var e,t={tag:"div",menu:!1,toBBCode:function(e){},toProduction:function(e,t){var r=e.attrs,i=['<span class="recommended">'+r.caption+'</span><div class="blog-item"><a href="'+r.link+'"><figure class="profile-image">'];return i.push('<img src="'+r.img+'?width=525&height=450&mode=crop&quality=60"></img>'),i.push("<figcaption>"),i.push(' <span class="category" style="background-color: '+r.catcolor+';">'+r.catname+"</span>"),i.push('<h2 class="title">'+r.title+"</h2>"),i.push("</figcaption></figure></a></div>"),'<div class="blog-list article-inline-promo hide-desktop">'+i.join("")}};return e=t}),r.module("morrr.editor.elements.intro",["morrr.editor.utils"],function(e){var t,r={tag:"div",menu:!0,stringWrapper:!0,icon:"intro",hint:"Intro paragraph",bindEditorEvents:function(e){this.basicStringWrapper(e,{service:"intro",onRemove:function(e){e.replaceWith("<div>"+e.find(".wrapper-editable-area").text()+"</div>")}})},toBBCode:function(t){t.find('*[data-service="intro"]').each(function(t,r){var i=$(r).find(".wrapper-editable-area").text();$(r).replaceWith("[intro]"+e.trimText(i)+"[/intro]")})},cmdSmart:function(e){var t=$('<div class="blog-intro">'+e.text.join(" ")+"</div>");$(e.elements).remove(),e.inject(t[0]),r.bindEditorEvents.apply(this,[t[0]])},toProduction:function(){return'<div class="blog-intro">'},processAfterRender:function(e,t,r){return e}};return t=r}),r.module("morrr.editor.elements.li",[],function(){var e,t={tag:"li",inline:!0,toBBCode:function(e){for(;e.find("li").length>0;)e.find("li").each(function(e,t){$(t).replaceWith("[li]"+$(t).html()+"[/li]")})}};return e=t}),r.module("morrr.editor.elements.list",[],function(){var e,t={tag:"li",menu:!1,inline:!0,toBBCode:function(e){e.find("li").each(function(e,t){$(t).replaceWith("[li]"+$(t).html()+"[/li]")})}};return e=t}),r.module("morrr.editor.elements.ol",[],function(){var e,t={tag:"ol",menu:!0,inline:!0,icon:"ordered-list",hint:"Numbered list",toBBCode:function(e){e.find("ol").each(function(e,t){$(t).replaceWith("[ol]"+$(t).html()+"[/ol]")})},cmd:function(){this.execCommand("insertorderedlist")},toProduction:function(e){return"<ol>"}};return e=t}),r.module("morrr.editor.elements.panorama",[],function(){var e,t={tag:"div",menu:!1,toBBCode:function(e){},toProduction:function(e,t){return'<div class="article-inline-ad hide-desktop">'}};return e=t}),r.module("morrr.editor.elements.strong",["morrr.editor.utils"],function(e){var t,r={tag:"strong",menu:!1,inline:!0,icon:"bold",hint:"Bold",toBBCode:function(t){t.find("strong,b").each(function(t,r){$(r).replaceWith("[strong]"+e.trimText($(r).text())+"[/strong]")})},cmd:function(){this.execCommand("bold")}};return t=r}),r.module("morrr.editor.elements.ul",[],function(){var e,t={tag:"ul",menu:!0,inline:!0,icon:"unordered-list",hint:"Bulleted list",toBBCode:function(e){for(;e.find("ul").length>0;)e.find("ul").each(function(e,t){$(t).replaceWith("[ul]"+$(t).html()+"[/ul]")})},cmd:function(){this.execCommand("insertunorderedlist")},toProduction:function(e){return"<ul>"}};return e=t}),r.module("morrr.editor.elements.unlink",[],function(){var e,t={menu:!0,inline:!0,icon:"unlink",hint:"Remove link",cmd:function(){this.execCommand("unlink",!1,[])}};return e=t}),r.module("morrr.editor.elements.url",[],function(){var e,t={tag:"a",menu:!0,inline:!0,icon:"link",hint:"Insert link",toBBCode:function(e){e.find("a").each(function(e,t){$(t).replaceWith("[url="+$(t).attr("href")+"]"+$(t).text()+"[/url]")})},cmd:function(){var e=prompt("Please specify the link.");e&&this.execCommand("createLink",!1,e)},toProduction:function(e){var t=e.attrs.self;return t=t.replace(/\sp=.*/,""),-1===t.indexOf("http")&&(t="http://"+t),'<a target="_blank" href="'+t+'">'}};return e=t}),r.module("morrr.editor.bbcode.AttributeParser",[],function(){var e,t=function(e){if(!e)return{};if("="===e[0])return{self:e.slice(1,e.length)};var t,r=!0,i=!1,n={},o="",a="",s=!1;for(var l in e){var u=e[l];"="===u&&(r=!1,n[o]="",i=!0),r&&u.match(/[a-z0-9_]/i)&&(o+=u),i&&(t?u!==t||s?"\\"!==u||s?(a+=u,s=!1):s=!0:(i=!1,r=!0,n[o]=a,t=!1,o="",a=""):u.match(/'|"/)&&(t=u))}return n};return e=t}),r.module("morrr.editor.bbcode.BBCodeEngine",["morrr.editor.bbcode.BBCodeExtractor","morrr.editor.utils.lodash","morrr.editor.bbcode.BBCodeHandlers","morrr.editor.utils"],function(e,t,r,i){var n,o={replaceEndTags:function(e){return t.each(r,function(t,r){t.tag&&(e=e.split("[/"+r+"]").join("</"+t.tag+">"))}),e},_injectSystemId:function(e,t){return e=i.stringInject(e,e.length-1,0,' id="'+t+'"')},_prepareInput:function(e){return e=e.replace(/\[row\]/g,"<div>"),e=e.replace(/\[\/row\]/g,"</div>"),e=e.replace(/\[\/br\]/g,"<div><br></div>"),e=this.replaceEndTags(e)},toProduction:function(i,n){n=n||{},i=this._prepareInput(i);var o=e(i);i=o.input;var a=o.codes;return t.each(a,function(e){var o,a;(o=r[e.name])&&(a=t.isFunction(o.toProduction)?o.toProduction(e,n):"<"+o.tag+">",i=i.replace(e.str,a))}),t.each(a,function(e){var o,a;(o=r[e.name])&&t.isFunction(o.processAfterRender)&&(a=o.processAfterRender(i,e,n))}),i},toEditor:function(i,n){i=this._prepareInput(i);var o=e(i),a=this;i=o.input;var s=o.codes,l={};t.each(s,function(e){var n,o;if(n=r[e.name]){if(o=t.isFunction(n.toProduction)?n.toProduction(e):"<"+n.tag+">",t.isFunction(n.bindEditorEvents)){var s="sane-element-"+e.attrs.p;o=a._injectSystemId(o,s),l[e.name]=l[e.name]||[],l[e.name].push(s)}i=i.replace(e.str,o)}});var u=$(i);n.content.append(u),t.each(l,function(e,i){t.each(e,function(e){var t=n.content.find("#"+e)[0];r[i].bindEditorEvents.apply(n,[t])})})}};return n=o}),r.module("morrr.editor.bbcode.BBCodeExtractor",["morrr.editor.bbcode.AttributeParser","morrr.editor.utils"],function(e,t){var r,i=function(r){for(var i=1,n=!1,o=!1,a=0;a<r.length;a++){var s=r[a];if("/"===s&&(n=!1),n){if(o&&"]"===s){var l=' p="'+i++ +'"';r=t.stringInject(r,a,0,l),a+=l.length-1,o=!1,n=!1}s.match(/[a-z0-9_]/i)&&(o=!0)}"["===s&&(n=!0)}var u=/\[([a-z0-9]+)\s?([^\]]+)?]/gim,c=u.execAll(r),d=[];return _.each(c,function(t){d.push({str:t[0],name:t[1],attrs:e(t[2])})}),{input:r,codes:d}};return r=i}),r.module("morrr.editor.bbcode.BBCodeHandlers",["morrr.editor.utils.Promise","morrr.editor.utils.lodash"],function(e,t){var i,n=r.requirePackage("morrr.editor.elements").then(function(e){var r={};return t.each(e,function(e,t){r[t.substring(22,t.length)]=e}),r});return i=n}),r.module("morrr.editor.bbcode.Generator",["morrr.editor.utils","morrr.editor.bbcode.BBCodeHandlers","morrr.editor.utils.lodash"],function(e,t,r){var i,n=function(i){var n=i.content.clone();r.each(t,function(e){e.toBBCode&&e.inline&&e.toBBCode.bind(i)(n)});var o=e.flattenNodes(i,n[0].childNodes);r.each(t,function(e){e.toBBCode&&!e.inline&&e.toBBCode.bind(i)($(o))});for(var a,s=[],l=!1,u=0;u<=o.childNodes.length;u++){var c=o.childNodes[u];if(c&&"X"!==c.nodeName){if(3===c.nodeType)if(c.nodeValue.match(/\[\S+\]/)){var d=e.trimText(c.nodeValue),p=d.match(/^\[(blockquote|gallery|intro|h3|h1)/);if(s.push(d),p&&(l=!0,a)){var h=s[a];"[/br]"===h&&s.splice(a,1)}}else s.push("[row]"+e.trimText(c.nodeValue,!0)+"[/row]");if(1===c.nodeType){var d=e.trimText($(c).text(),!0),f=""===d.replace(/\[\/?[^\]]+(\]|$)/g,"");f&&(d=""),d.length>0&&(a=null,l=!1),l||(0===d.length?(s.push("[/br]"),a=s.length-1):s.push("[row]"+d+"[/row]")),l=!d}}}var m=e.cleanUpItems(s.join("\n"));return m};return i=n})}(function(e){var t="undefined"!=typeof exports;return{isNode:t,realm:t?require("realm-js"):window.realm}}()),function(e){"use strict";e.isNode,e.realm;riot.tag2("notifications","<span></span>","#growls { z-index: 9999999; position: fixed; } #growls.default { top: 30px; right: 0; font-family: sans-serif; font-size: 14px; } #growls.tl { top: 10px; left: 10px; } #growls.tr { top: 10px; right: 10px; } #growls.bl { bottom: 10px; left: 10px; } #growls.br { bottom: 10px; right: 10px; } #growls.tc { top: 10px; right: 10px; left: 10px; } #growls.bc { bottom: 10px; right: 10px; left: 10px; } #growls.bc .growl, #growls.tc .growl { margin-left: auto; margin-right: auto; } .growl { opacity: 0.8; filter: alpha(opacity=80); position: relative; border-radius: 4px; -webkit-transition: all 0.2s ease-in-out; -moz-transition: all 0.2s ease-in-out; transition: all 0.2s ease-in-out; } .growl.growl-incoming { opacity: 0; filter: alpha(opacity=0); } .growl.growl-outgoing { opacity: 0; filter: alpha(opacity=0); transform: translateY(-20px); } .growl.growl-small { width: 200px; padding: 5px; margin: 5px; } .growl.growl-medium { width: 250px; padding: 10px; margin: 10px; } .growl.growl-large { width: 300px; padding: 15px; margin: 15px; } .growl.growl-default { color: #FFF; background: rgba(0,0,0,0.8); } .growl.growl-error { color: #FFF; background: #DD0000; } .growl.growl-notice { color: #FFF; background: green; } .growl.growl-warning { color: #FFF; background: orange; } .growl .growl-close { cursor: pointer; float: right; font-size: 14px; line-height: 14px; font-weight: normal; font-family: helvetica, verdana, sans-serif; } .growl .growl-title { font-size: 14px; line-height: 18px; display: none; } .growl .growl-message { font-size: 12px; line-height: 16px; letter-spacing: 0.05em; -webkit-font-smoothing: 'antialiased'; }","",function(e){this.on("default",function(e){var t=e;"string"==typeof e&&(t={},t.message=e),$.growl(t)}),this.on("notice",function(e){var t=e;"string"==typeof e&&(t={},t.message=e),$.growl.notice(t)}),this.on("error",function(e){var t=e;"string"==typeof e&&(t={},t.message=e),$.growl.error(t)}),this.on("warning",function(e){var t=e;"string"==typeof e&&(t={},t.message=e),$.growl.warning(t)})})}(function(e){var t="undefined"!=typeof exports;return{isNode:t,realm:t?require("realm-js"):window.realm}}());